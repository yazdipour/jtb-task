FROM maven:3.9-eclipse-temurin-21-alpine

WORKDIR /app

# Install required tools
RUN apk add --no-cache bash curl findutils tar

# Copy pom.xml and download dependencies (cached unless pom.xml changes)
COPY pom.xml .
RUN mvn -q dependency:resolve

# Copy source files (changes frequently, doesn't invalidate dependency cache)
COPY src ./src
COPY scripts ./scripts

CMD ["bash"]
